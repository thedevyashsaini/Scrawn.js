syntax = "proto3";

package auth.v1;

service AuthService {
  // SignJWT signs a payload and returns a JWT token
  rpc SignJWT(SignJWTRequest) returns (SignJWTResponse) {}

  // GetRoles extracts and returns the roles array from a JWT payload
  rpc GetRoles(GetRolesRequest) returns (GetRolesResponse) {}
}

message UserPayload {
  string id = 1;
  repeated string roles = 2;
}

message SignJWTRequest {
  UserPayload payload = 1;
  string secret = 2;
}

message SignJWTResponse {
  string token = 1;
}

message GetRolesRequest {
  string token = 1;
}

message GetRolesResponse {
  repeated string roles = 1;
}
